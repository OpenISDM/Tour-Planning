SET
I  first /1*34/
K(I)  depot1 /1*4/
O(I)  node1 /5*34/
alias(I,J);
alias(K,L);
alias(O,P);
TABLE C(I,J)  node to node
                          1                         2                         3                         4                         5                         6                         7                         8                         9                         10                        11                        12                        13                        14                        15                        16                        17                        18                        19                        20                        21                        22                        23                        24                        25                        26                        27                        28                        29                        30                        31                        32                        33                        34                        
1                         99999.0                   99999.0                   99999.0                   99999.0                   14.4222                   22.0                      26.5707                   35.805                    56.6392                   56.0446                   34.1321                   21.095                    30.4138                   24.0832                   41.1096                   28.0179                   38.833                    47.2969                   47.2969                   55.4437                   71.4003                   80.9938                   72.1249                   66.7533                   61.4003                   60.407                    59.9416                   57.4891                   53.7587                   43.1856                   34.6699                   25.0                      18.0                      40.6079                   
2                         99999.0                   99999.0                   99999.0                   99999.0                   41.7612                   32.0624                   23.0217                   12.083                    17.2047                   23.7697                   21.095                    28.2312                   47.2969                   58.8218                   80.6598                   65.0                      54.5894                   48.3011                   30.4138                   19.2354                   31.4006                   41.1825                   37.1214                   36.7696                   42.45                     50.6063                   56.0803                   62.1691                   61.4003                   53.0                      43.1045                   32.0156                   27.7849                   68.7095                   
3                         99999.0                   99999.0                   99999.0                   99999.0                   53.6656                   52.4976                   48.2701                   45.1885                   50.04                     30.4138                   16.1555                   21.4709                   21.4709                   43.6807                   69.6419                   68.884                    76.0263                   77.2334                   64.846                    55.2268                   57.5674                   62.6099                   43.9318                   34.0588                   21.587                    18.7883                   20.6155                   25.318                    25.02                     18.7883                   13.0384                   16.7631                   25.0599                   43.2782                   
4                         99999.0                   99999.0                   99999.0                   99999.0                   51.6236                   59.0339                   61.0328                   65.7647                   80.2309                   66.7083                   45.2769                   35.4401                   17.2047                   17.6918                   38.3275                   52.4023                   75.5844                   84.8999                   82.0                      82.5651                   91.4166                   98.2293                   81.3204                   71.7008                   57.8014                   48.7032                   42.7551                   33.0151                   28.0179                   22.1359                   24.7588                   31.7805                   36.6742                   5.6569                    
5                         14.4222                   41.7612                   53.6656                   51.6236                   99999.0                   12.8062                   21.4009                   33.6155                   56.356                    62.0725                   42.9535                   32.2025                   44.6878                   36.4966                   47.0106                   23.8537                   24.4131                   34.1321                   38.9487                   53.0094                   72.0139                   82.4621                   77.5242                   74.027                    71.5681                   72.45                     72.9452                   71.4493                   67.897                    57.28                     48.2701                   37.2156                   28.6356                   54.1202                   
6                         22.0                      32.0624                   52.4976                   59.0339                   12.8062                   99999.0                   9.4868                    22.1359                   44.9444                   54.4518                   38.9487                   31.8904                   48.7545                   46.0435                   59.4811                   36.2353                   24.1661                   26.4008                   26.4008                   40.8167                   60.7454                   71.4703                   69.0072                   67.082                    67.5426                   70.8025                   72.8629                   73.6003                   70.7248                   60.208                    50.2195                   37.6431                   28.4253                   62.3939                   
7                         26.5707                   23.0217                   48.2701                   61.0328                   21.4009                   9.4868                    99999.0                   12.6491                   35.4683                   46.0977                   33.3017                   29.5466                   48.5077                   50.2195                   66.5733                   45.2217                   31.7805                   29.0                      21.095                    31.6228                   51.264                    61.9839                   60.1332                   58.9406                   61.0574                   65.7951                   68.884                    71.1969                   68.8767                   58.6941                   48.3322                   35.3412                   26.5707                   65.0308                   
8                         35.805                    12.083                    45.1885                   65.7647                   33.6155                   22.1359                   12.6491                   99999.0                   22.8473                   35.8469                   29.0689                   31.0                      51.0                      57.7754                   76.8375                   57.4543                   43.1045                   36.2353                   19.7231                   19.799                    38.6264                   49.3356                   48.6621                   48.8467                   53.8145                   60.803                    65.3682                   69.8928                   68.4105                   59.0339                   48.6621                   36.1248                   29.1548                   70.406                    
9                         56.6392                   17.2047                   50.04                     80.2309                   56.356                    44.9444                   35.4683                   22.8473                   99999.0                   25.9422                   35.9026                   45.1774                   63.5689                   76.0263                   97.5807                   80.1311                   64.2806                   53.6004                   32.0156                   8.6023                    15.8114                   26.6833                   31.9061                   36.8782                   48.8467                   59.9083                   66.9104                   75.0267                   75.06                     67.7422                   58.4637                   48.4665                   44.9444                   85.4927                   
10                        56.0446                   23.7697                   30.4138                   66.7083                   62.0725                   54.4518                   46.0977                   35.8469                   25.9422                   99999.0                   23.3238                   37.1214                   49.5782                   68.2422                   93.1504                   83.5464                   77.8781                   72.0139                   53.0094                   33.8378                   28.1603                   32.2025                   16.1555                   13.0                      23.0868                   35.1283                   43.0116                   52.9528                   54.1202                   49.1935                   42.2019                   37.2022                   39.0                      72.3464                   
11                        34.1321                   21.095                    16.1555                   45.2769                   42.9535                   38.9487                   33.3017                   29.0689                   35.9026                   23.3238                   99999.0                   13.9284                   28.178                    45.0                      69.8355                   62.1289                   63.0635                   62.2415                   48.7647                   40.0125                   46.1411                   53.2635                   39.3573                   32.7567                   28.7924                   32.5269                   36.3593                   41.2311                   40.3113                   32.0624                   22.561                    14.1421                   16.2788                   50.774                    
12                        21.095                    28.2312                   21.4709                   35.4401                   32.2025                   31.8904                   29.5466                   31.0                      45.1774                   37.1214                   13.9284                   99999.0                   20.0                      31.8277                   56.0803                   49.0102                   54.8179                   57.6888                   49.0306                   47.1275                   57.6281                   65.7647                   53.2259                   46.5725                   40.3113                   40.2492                   41.2311                   41.8808                   39.3573                   29.1548                   18.7883                   5.831                     3.6056                    40.4969                   
13                        30.4138                   47.2969                   21.4709                   17.2047                   44.6878                   48.7545                   48.5077                   51.0                      63.5689                   49.5782                   28.178                    20.0                      99999.0                   23.0868                   48.8365                   53.3104                   69.029                    75.1532                   68.7314                   66.4906                   74.3034                   81.0247                   64.4438                   55.2178                   42.72                     36.0555                   32.5576                   27.4591                   23.4307                   13.0384                   8.544                     15.2971                   22.2036                   22.8035                   
14                        24.0832                   58.8218                   43.6807                   17.6918                   36.4966                   46.0435                   50.2195                   57.7754                   76.0263                   68.2422                   45.0                      31.8277                   23.0868                   99999.0                   25.9615                   34.7131                   59.4643                   70.5762                   71.1969                   76.5376                   89.2749                   97.591                    84.0595                   76.0263                   65.2534                   59.1354                   55.1453                   47.8017                   43.0116                   34.3657                   31.4006                   31.0644                   31.241                    18.3576                   
15                        41.1096                   80.6598                   69.6419                   38.3275                   47.0106                   59.4811                   66.5733                   76.8375                   97.5807                   93.1504                   69.8355                   56.0803                   48.8365                   25.9615                   99999.0                   30.0167                   63.1981                   78.6448                   85.8662                   96.5401                   111.9464                  121.0372                  109.1788                  101.6366                  91.214                    84.7172                   80.0562                   71.2531                   66.2722                   59.0339                   57.2713                   56.3649                   54.6443                   35.171                    
16                        28.0179                   65.0                      68.884                    52.4023                   23.8537                   36.2353                   45.2217                   57.4543                   80.1311                   83.5464                   62.1289                   49.0102                   53.3104                   34.7131                   30.0167                   99999.0                   33.541                    49.98                     61.0737                   76.844                    95.7131                   106.0236                  99.4636                   94.6414                   89.202                    87.0976                   85.3815                   80.4984                   76.0592                   66.2118                   59.7746                   52.345                    46.0109                   52.4023                   
17                        38.833                    54.5894                   76.0263                   75.5844                   24.4131                   24.1661                   31.7805                   43.1045                   64.2806                   77.8781                   63.0635                   54.8179                   69.029                    59.4643                   63.1981                   33.541                    99999.0                   17.8045                   35.8469                   58.0517                   79.7621                   90.7965                   91.6624                   90.7083                   91.7061                   94.578                    96.0469                   95.483                    92.0978                   81.4678                   72.1249                   60.3075                   51.225                    77.6209                   
18                        47.2969                   48.3011                   77.2334                   84.8999                   34.1321                   26.4008                   29.0                      36.2353                   53.6004                   72.0139                   62.2415                   57.6888                   75.1532                   70.5762                   78.6448                   49.98                     17.8045                   99999.0                   22.0                      46.0977                   68.0661                   79.0253                   83.8153                   85.0                      89.4036                   94.7629                   97.8366                   99.5691                   96.8969                   86.4523                   76.3217                   63.5138                   54.3783                   87.8635                   
19                        47.2969                   30.4138                   64.846                    82.0                      38.9487                   26.4008                   21.095                    19.7231                   32.0156                   53.0094                   48.7647                   49.0306                   68.7314                   71.1969                   85.8662                   61.0737                   35.8469                   22.0                      99999.0                   24.1868                   46.0977                   57.0351                   63.1585                   65.7343                   72.8629                   80.4487                   85.0882                   89.3197                   87.5957                   77.8845                   67.4463                   54.5711                   46.5296                   86.093                    
20                        55.4437                   19.2354                   55.2268                   82.5651                   53.0094                   40.8167                   31.6228                   19.799                    8.6023                    33.8378                   40.0125                   47.1275                   66.4906                   76.5376                   96.5401                   76.844                    58.0517                   46.0977                   24.1868                   99999.0                   22.0                      33.0151                   40.4969                   45.2769                   56.356                    66.7308                   73.2462                   80.5047                   80.0999                   72.0625                   62.2896                   51.1957                   46.2385                   87.5957                   
21                        71.4003                   31.4006                   57.5674                   91.4166                   72.0139                   60.7454                   51.264                    38.6264                   15.8114                   28.1603                   46.1411                   57.6281                   74.3034                   89.2749                   111.9464                  95.7131                   79.7621                   68.0661                   46.0977                   22.0                      99999.0                   11.0454                   25.0599                   34.2053                   50.1597                   63.0                      71.1126                   81.0494                   82.0                      76.2168                   68.0294                   59.9083                   58.0517                   96.8969                   
22                        80.9938                   41.1825                   62.6099                   98.2293                   82.4621                   71.4703                   61.9839                   49.3356                   26.6833                   32.2025                   53.2635                   65.7647                   81.0247                   97.591                    121.0372                  106.0236                  90.7965                   79.0253                   57.0351                   33.0151                   11.0454                   99999.0                   23.0217                   34.0588                   51.4782                   64.9384                   73.5459                   84.4808                   86.0349                   81.3941                   74.0945                   67.3573                   66.6033                   103.8123                  
23                        72.1249                   37.1214                   43.9318                   81.3204                   77.5242                   69.0072                   60.1332                   48.6621                   31.9061                   16.1555                   39.3573                   53.2259                   64.4438                   84.0595                   109.1788                  99.4636                   91.6624                   83.8153                   63.1585                   40.4969                   25.0599                   23.0217                   99999.0                   11.4018                   29.1204                   42.72                     51.5461                   63.1585                   65.2993                   62.2013                   56.5685                   53.0                      55.1543                   86.977                    
24                        66.7533                   36.7696                   34.0588                   71.7008                   74.027                    67.082                    58.9406                   48.8467                   36.8782                   13.0                      32.7567                   46.5725                   55.2178                   76.0263                   101.6366                  94.6414                   90.7083                   85.0                      65.7343                   45.2769                   34.2053                   34.0588                   11.4018                   99999.0                   17.72                     31.3209                   40.1622                   51.8941                   54.2033                   51.7397                   47.0106                   45.31                     49.0306                   77.3369                   
25                        61.4003                   42.45                     21.587                    57.8014                   71.5681                   67.5426                   61.0574                   53.8145                   48.8467                   23.0868                   28.7924                   40.3113                   42.72                     65.2534                   91.214                    89.202                    91.7061                   89.4036                   72.8629                   56.356                    50.1597                   51.4782                   29.1204                   17.72                     99999.0                   13.6015                   22.4722                   34.4819                   37.2022                   36.4005                   34.176                    37.0                      43.566                    63.2851                   
26                        60.407                    50.6063                   18.7883                   48.7032                   72.45                     70.8025                   65.7951                   60.803                    59.9083                   35.1283                   32.5269                   40.2492                   36.0555                   59.1354                   84.7172                   87.0976                   94.578                    94.7629                   80.4487                   66.7308                   63.0                      64.9384                   42.72                     31.3209                   13.6015                   99999.0                   8.9443                    21.4009                   24.7588                   26.5707                   28.0179                   35.4683                   43.8292                   53.8516                   
27                        59.9416                   56.0803                   20.6155                   42.7551                   72.9452                   72.8629                   68.884                    65.3682                   66.9104                   43.0116                   36.3593                   41.2311                   32.5576                   55.1453                   80.0562                   85.3815                   96.0469                   97.8366                   85.0882                   73.2462                   71.1126                   73.5459                   51.5461                   40.1622                   22.4722                   8.9443                    99999.0                   12.7279                   16.6433                   21.0238                   25.632                    35.805                    44.8219                   47.5395                   
28                        57.4891                   62.1691                   25.318                    33.0151                   71.4493                   73.6003                   71.1969                   69.8928                   75.0267                   52.9528                   41.2311                   41.8808                   27.4591                   47.8017                   71.2531                   80.4984                   95.483                    99.5691                   89.3197                   80.5047                   81.0494                   84.4808                   63.1585                   51.8941                   34.4819                   21.4009                   12.7279                   99999.0                   5.0                       14.4222                   23.4307                   36.0555                   45.2217                   37.1214                   
29                        53.7587                   61.4003                   25.02                     28.0179                   67.897                    70.7248                   68.8767                   68.4105                   75.06                     54.1202                   40.3113                   39.3573                   23.4307                   43.0116                   66.2722                   76.0592                   92.0978                   96.8969                   87.5957                   80.0999                   82.0                      86.0349                   65.2993                   54.2033                   37.2022                   24.7588                   16.6433                   5.0                       99999.0                   10.6301                   20.5913                   33.541                    42.5441                   32.1403                   
30                        43.1856                   53.0                      18.7883                   22.1359                   57.28                     60.208                    58.6941                   59.0339                   67.7422                   49.1935                   32.0624                   29.1548                   13.0384                   34.3657                   59.0339                   66.2118                   81.4678                   86.4523                   77.8845                   72.0625                   76.2168                   81.3941                   62.2013                   51.7397                   36.4005                   26.5707                   21.0238                   14.4222                   10.6301                   99999.0                   10.4403                   23.4094                   32.2025                   27.313                    
31                        34.6699                   43.1045                   13.0384                   24.7588                   48.2701                   50.2195                   48.3322                   48.6621                   58.4637                   42.2019                   22.561                    18.7883                   8.544                     31.4006                   57.2713                   59.7746                   72.1249                   76.3217                   67.4463                   62.2896                   68.0294                   74.0945                   56.5685                   47.0106                   34.176                    28.0179                   25.632                    23.4307                   20.5913                   10.4403                   99999.0                   13.0                      21.9545                   30.4138                   
32                        25.0                      32.0156                   16.7631                   31.7805                   37.2156                   37.6431                   35.3412                   36.1248                   48.4665                   37.2022                   14.1421                   5.831                     15.2971                   31.0644                   56.3649                   52.345                    60.3075                   63.5138                   54.5711                   51.1957                   59.9083                   67.3573                   53.0                      45.31                     37.0                      35.4683                   35.805                    36.0555                   33.541                    23.4094                   13.0                      99999.0                   9.2195                    37.1214                   
33                        18.0                      27.7849                   25.0599                   36.6742                   28.6356                   28.4253                   26.5707                   29.1548                   44.9444                   39.0                      16.2788                   3.6056                    22.2036                   31.241                    54.6443                   46.0109                   51.225                    54.3783                   46.5296                   46.2385                   58.0517                   66.6033                   55.1543                   49.0306                   43.566                    43.8292                   44.8219                   45.2217                   42.5441                   32.2025                   21.9545                   9.2195                    99999.0                   41.4849                   
34                        40.6079                   68.7095                   43.2782                   5.6569                    54.1202                   62.3939                   65.0308                   70.406                    85.4927                   72.3464                   50.774                    40.4969                   22.8035                   18.3576                   35.171                    52.4023                   77.6209                   87.8635                   86.093                    87.5957                   96.8969                   103.8123                  86.977                    77.3369                   63.2851                   53.8516                   47.5395                   37.1214                   32.1403                   27.313                    30.4138                   37.1214                   41.4849                   99999.0                   
;
SCALAR TOTAL  /34/;
SCALAR NODES  /30/;
SCALAR W  /1/;
SCALAR Y  /34/;
SCALAR M  /1/;
BINARY VARIABLE X(I,J,K)  x variable ;
INTEGER VARIABLE U(K,O)    u variable ;
VARIABLE   Z         objective ;
EQUATIONS
CON1(K)   constraint 1
CON2(K)   constraint 2
CON3   constraint 3
CON4(O)   constraint 4
CON5(O,K)   constraint 5
CON6(O,K)   constraint 6
CON7(K)   constraint 7
CON10(O,P,K)   constraint 10
CON11(O,K)   constraint 11;
CON1(K).. SUM(O,X(K,O,K)) =E= 1;
CON2(K).. SUM(O,X(O,K,K)) =E= 1;
CON3..  SUM((K,L),X(K,L,K)) =E= 0;
CON4(O) .. SUM(K,X(K,O,K)) + SUM((P,K),X(P,O,K)) =e= W;
CON5(O,K) .. X(K,O,K) + SUM(P,X(P,O,K)) =L= 1;
CON6(O,K) .. X(K,O,K) + SUM(P,X(P,O,K)) - X(O,K,K) - SUM(P,X(O,P,K)) =e= 0;
CON7(K) .. Z =G= SUM(O,C(K,O)*X(K,O,K) + C(O,K)*X(O,K,K)) + SUM((P,O),C(P,O)*X(P,O,K));
CON10(O,P,K) .. U(K,O) - U(K,P) + (TOTAL-1)*X(O,P,K) + (TOTAL-3)*X(P,O,K) =L= (TOTAL-2);
CON11(O,K) .. X(O,O,K) =e= 0;
MODEL TRANSPORT /ALL/;
SOLVE TRANSPORT USING MIP MINIMIZING Z ;
