SET
I  first /1*34/
K(I)  depot1 /1*4/
O(I)  node1 /5*34/
alias(I,J);
alias(K,L);
alias(O,P);
TABLE C(I,J)  node to node
                          1                         2                         3                         4                         5                         6                         7                         8                         9                         10                        11                        12                        13                        14                        15                        16                        17                        18                        19                        20                        21                        22                        23                        24                        25                        26                        27                        28                        29                        30                        31                        32                        33                        34                        
1                         99999.0                   99999.0                   99999.0                   99999.0                   48.3735                   38.3275                   36.1386                   34.8855                   40.4599                   69.3542                   66.2873                   53.7587                   70.0071                   50.1597                   7.2111                    25.5539                   27.074                    32.6497                   31.7648                   25.02                     8.4853                    12.0416                   36.4005                   62.8172                   67.0075                   72.3395                   84.2021                   92.5743                   103.8316                  118.8276                  106.8504                  94.8314                   85.0059                   76.5376                   
2                         99999.0                   99999.0                   99999.0                   99999.0                   80.0                      65.215                    60.2163                   52.2015                   37.4833                   52.1728                   58.8727                   41.5933                   26.9258                   8.9443                    54.3323                   38.2753                   62.1691                   85.6154                   33.541                    33.0151                   52.345                    66.6108                   76.4788                   95.1315                   89.2749                   88.2326                   88.2383                   84.7231                   91.351                    89.2861                   65.0                      41.0488                   27.0185                   27.4591                   
3                         99999.0                   99999.0                   99999.0                   99999.0                   70.8308                   63.561                    61.2944                   57.4282                   49.679                    20.6155                   27.5136                   36.1248                   38.0526                   61.3922                   82.7345                   65.437                    71.3442                   97.9439                   86.406                    75.2928                   90.2718                   101.8332                  78.5493                   78.0577                   64.0703                   56.5685                   43.4626                   29.0689                   29.9666                   29.0689                   29.1204                   50.2195                   68.6222                   42.2019                   
4                         99999.0                   99999.0                   99999.0                   99999.0                   23.4307                   28.2843                   31.0                      35.6931                   45.6508                   40.8534                   30.0832                   41.7253                   68.8186                   74.3303                   60.208                    54.5711                   39.6232                   56.4004                   83.1986                   68.884                    72.0625                   76.9025                   36.3593                   24.5153                   10.0499                   6.3246                    20.5183                   36.2353                   48.0208                   75.6902                   82.6075                   93.4773                   101.3163                  77.1038                   
5                         48.3735                   80.0                      70.8308                   23.4307                   99999.0                   14.8661                   19.8494                   27.8029                   43.0465                   53.0848                   43.566                    46.3249                   74.3303                   71.218                    43.1741                   44.8219                   22.4722                   33.0151                   71.5891                   57.9828                   55.3173                   57.0351                   13.6015                   15.8114                   19.6469                   27.2947                   43.9318                   58.6003                   70.6045                   95.8541                   97.3293                   101.1385                  103.3538                  82.8613                   
6                         38.3275                   65.215                    63.561                    28.2843                   14.8661                   99999.0                   5.0                       13.0384                   28.6356                   43.9659                   36.2353                   34.0147                   61.1882                   56.4004                   32.0156                   30.2324                   11.4018                   34.4819                   57.7754                   43.8292                   44.0114                   48.7647                   15.2971                   30.4795                   29.6142                   34.0588                   46.6154                   57.6281                   69.527                    90.7359                   87.8635                   88.2836                   89.0                      69.6348                   
7                         36.1386                   60.2163                   61.2944                   31.0                      19.8494                   5.0                       99999.0                   8.0623                    23.7697                   41.2311                   34.4093                   30.0666                   56.7186                   51.4004                   29.4279                   25.5539                   10.6301                   36.7696                   53.4883                   39.3954                   41.1096                   47.1699                   19.0                      35.3836                   33.5261                   37.054                    48.0833                   57.6888                   69.4046                   89.0505                   84.6463                   83.863                    84.0952                   65.1153                   
8                         34.8855                   52.2015                   57.4282                   35.6931                   27.8029                   13.0384                   8.0623                    99999.0                   15.8114                   36.8917                   31.8904                   23.7697                   49.2544                   43.4166                   27.7308                   18.9737                   14.5602                   42.2019                   47.5395                   33.2415                   38.3275                   46.6476                   26.3059                   43.1393                   39.8121                   41.9762                   50.4876                   57.6975                   68.9638                   85.9127                   79.0569                   76.4199                   76.0592                   57.5587                   
9                         40.4599                   37.4833                   49.679                    45.6508                   43.0465                   28.6356                   23.7697                   15.8114                   99999.0                   29.6816                   29.6142                   13.6015                   34.0                      29.0689                   33.6006                   15.8114                   29.0172                   56.2228                   41.1096                   27.6586                   40.6079                   52.4023                   41.9762                   57.8014                   52.0096                   51.8845                   55.5788                   57.8705                   67.72                     78.7464                   67.082                    61.0737                   60.3738                   42.107                    
10                        69.3542                   52.1728                   20.6155                   40.8534                   53.0848                   43.9659                   41.2311                   36.8917                   29.6816                   99999.0                   10.7703                   16.1245                   30.8058                   47.0956                   62.2415                   45.4863                   51.0                      78.0                      68.6804                   56.4624                   70.214                    81.3941                   59.203                    62.8013                   50.5964                   45.1774                   38.4187                   32.5576                   40.1123                   49.4975                   44.2832                   53.0                      64.405                    38.2099                   
11                        66.2873                   58.8727                   27.5136                   30.0832                   43.566                    36.2353                   34.4093                   31.8904                   29.6142                   10.7703                   99999.0                   18.1108                   40.3113                   52.6308                   59.0762                   44.5982                   44.8219                   70.7107                   70.5762                   57.2713                   68.4251                   78.2368                   51.0784                   52.345                    39.8497                   34.4819                   29.5296                   28.2843                   38.2753                   54.6443                   54.0093                   63.6318                   73.7564                   48.1664                   
12                        53.7587                   41.5933                   36.1248                   41.7253                   46.3249                   34.0147                   30.0666                   23.7697                   13.6015                   16.1245                   18.1108                   99999.0                   28.2312                   34.7851                   46.7547                   29.4109                   38.3275                   65.9697                   53.1507                   40.4969                   54.2033                   65.7647                   49.0408                   59.0931                   50.0                      47.4236                   46.8188                   46.0435                   55.109                    65.192                    55.3624                   54.8179                   59.6657                   36.7696                   
13                        70.0071                   26.9258                   38.0526                   68.8186                   74.3303                   61.1882                   56.7186                   49.2544                   34.0                      30.8058                   40.3113                   28.2312                   99999.0                   26.6271                   64.195                    44.9222                   63.0079                   90.1388                   55.2268                   48.2597                   67.1193                   80.9568                   75.5381                   87.3212                   77.6981                   74.027                    69.2026                   61.8466                   66.7083                   62.3618                   39.6989                   27.1662                   33.6006                   8.544                     
14                        50.1597                   8.9443                    61.3922                   74.3303                   71.218                    56.4004                   51.4004                   43.4166                   29.0689                   47.0956                   52.6308                   34.7851                   26.6271                   99999.0                   46.0435                   29.4109                   53.2259                   76.9025                   29.0689                   25.4951                   45.1221                   59.439                    67.5352                   86.4523                   81.0555                   80.455                    81.5966                   79.511                    87.0                      88.0227                   66.2193                   46.0977                   35.3553                   29.8329                   
15                        7.2111                    54.3323                   82.7345                   60.208                    43.1741                   32.0156                   29.4279                   27.7308                   33.6006                   62.2415                   59.0762                   46.7547                   64.195                    46.0435                   99999.0                   19.3132                   21.095                    32.6497                   31.8904                   22.1359                   12.1655                   19.2094                   32.2025                   58.1893                   61.2046                   66.0681                   77.3692                   85.4283                   96.6488                   111.7318                  100.3444                  89.627                    81.3019                   71.0634                   
16                        25.5539                   38.2753                   65.437                    54.5711                   44.8219                   30.2324                   25.5539                   18.9737                   15.8114                   45.4863                   44.5982                   29.4109                   44.9222                   29.4109                   19.3132                   99999.0                   24.4131                   47.676                    28.6356                   14.3178                   24.8395                   37.2022                   38.833                    60.6053                   58.6941                   60.8769                   68.0074                   72.5328                   82.8734                   94.4934                   81.3019                   70.7107                   64.5368                   51.9711                   
17                        27.074                    62.1691                   71.3442                   39.6232                   22.4722                   11.4018                   10.6301                   14.5602                   29.0172                   51.0                      44.8219                   38.3275                   63.0079                   53.2259                   21.095                    24.4131                   99999.0                   27.6586                   49.3964                   36.2353                   33.2415                   37.3631                   14.4222                   38.0132                   40.1123                   45.2769                   57.9396                   68.2422                   80.0                      99.4032                   93.6056                   90.0888                   87.5957                   71.1126                   
18                        32.6497                   85.6154                   97.9439                   56.4004                   33.0151                   34.4819                   36.7696                   42.2019                   56.2228                   78.0                      70.7107                   65.9697                   90.1388                   76.9025                   32.6497                   47.676                    27.6586                   99999.0                   64.0703                   54.626                    41.1096                   34.4819                   20.5183                   41.2311                   51.8845                   60.208                    76.8375                   90.5539                   102.5914                  125.1958                  121.1652                  117.0171                  112.1784                  98.0204                   
19                        31.7648                   33.541                    86.406                    83.1986                   71.5891                   57.7754                   53.4883                   47.5395                   41.1096                   68.6804                   70.5762                   53.1507                   55.2268                   29.0689                   31.8904                   28.6356                   49.3964                   64.0703                   99999.0                   14.3178                   23.7697                   36.4966                   62.8013                   87.3212                   86.977                    89.4986                   96.1301                   98.8585                   108.2589                  114.5295                  94.921                    74.4312                   58.6941                   58.8982                   
20                        25.02                     33.0151                   75.2928                   68.884                    57.9828                   43.8292                   39.3954                   33.2415                   27.6586                   56.4624                   57.2713                   40.4969                   48.2597                   25.4951                   22.1359                   14.3178                   36.2353                   54.626                    14.3178                   99999.0                   19.6469                   33.9559                   50.2096                   73.7835                   72.8011                   75.1864                   82.0244                   85.5102                   95.3362                   104.0096                  87.2067                   71.1688                   60.0                      53.6656                   
21                        8.4853                    52.345                    90.2718                   72.0625                   55.3173                   44.0114                   41.1096                   38.3275                   40.6079                   70.214                    68.4251                   54.2033                   67.1193                   45.1221                   12.1655                   24.8395                   33.2415                   41.1096                   23.7697                   19.6469                   99999.0                   14.3178                   44.0114                   70.214                    73.3348                   78.0064                   88.6454                   95.6347                   106.5129                  119.3315                  105.2093                  90.7579                   79.1581                   73.0068                   
22                        12.0416                   66.6108                   101.8332                  76.9025                   57.0351                   48.7647                   47.1699                   46.6476                   52.4023                   81.3941                   78.2368                   65.7647                   80.9568                   59.439                    19.2094                   37.2022                   37.3631                   34.4819                   36.4966                   33.9559                   14.3178                   99999.0                   44.0454                   70.3491                   76.3217                   82.3772                   95.1893                   104.2353                  115.6028                  130.8625                  118.4314                  104.9952                  93.3435                   87.0919                   
23                        36.4005                   76.4788                   78.5493                   36.3593                   13.6015                   15.2971                   19.0                      26.3059                   41.9762                   59.203                    51.0784                   49.0408                   75.5381                   67.5352                   32.2025                   38.833                    14.4222                   20.5183                   62.8013                   50.2096                   44.0114                   44.0454                   99999.0                   26.4764                   33.2415                   40.7185                   56.6127                   70.0357                   82.0731                   105.1903                  103.1601                  102.7035                  101.5923                  83.863                    
24                        62.8172                   95.1315                   78.0577                   24.5153                   15.8114                   30.4795                   35.3836                   43.1393                   57.8014                   62.8013                   52.345                    59.0931                   87.3212                   86.4523                   58.1893                   60.6053                   38.0132                   41.2311                   87.3212                   73.7835                   70.214                    70.3491                   26.4764                   99999.0                   15.2315                   24.5967                   42.9418                   60.1664                   71.5891                   100.1699                  106.1179                  113.5473                  117.6605                  95.8541                   
25                        67.0075                   89.2749                   64.0703                   10.0499                   19.6469                   29.6142                   33.5261                   39.8121                   52.0096                   50.5964                   39.8497                   50.0                      77.6981                   81.0555                   61.2046                   58.6941                   40.1123                   51.8845                   86.977                    72.8011                   73.3348                   76.3217                   33.2415                   15.2315                   99999.0                   9.434                     27.7849                   44.9444                   56.3649                   85.1469                   92.6553                   102.8834                  109.6358                  86.093                    
26                        72.3395                   88.2326                   56.5685                   6.3246                    27.2947                   34.0588                   37.054                    41.9762                   51.8845                   45.1774                   34.4819                   47.4236                   74.027                    80.455                    66.0681                   60.8769                   45.2769                   60.208                    89.4986                   75.1864                   78.0064                   82.3772                   40.7185                   24.5967                   9.434                     99999.0                   18.3576                   35.7351                   47.0106                   76.2955                   85.5102                   98.1122                   106.8316                  82.201                    
27                        84.2021                   88.2383                   43.4626                   20.5183                   43.9318                   46.6154                   48.0833                   50.4876                   55.5788                   38.4187                   29.5296                   46.8188                   69.2026                   81.5966                   77.3692                   68.0074                   57.9396                   76.8375                   96.1301                   82.0244                   88.6454                   95.1893                   56.6127                   42.9418                   27.7849                   18.3576                   99999.0                   18.1108                   28.7924                   59.2115                   72.45                     90.1388                   102.8008                  76.5768                   
28                        92.5743                   84.7231                   29.0689                   36.2353                   58.6003                   57.6281                   57.6888                   57.6975                   57.8705                   32.5576                   28.2843                   46.0435                   61.8466                   79.511                    85.4283                   72.5328                   68.2422                   90.5539                   98.8585                   85.5102                   95.6347                   104.2353                  70.0357                   60.1664                   44.9444                   35.7351                   18.1108                   99999.0                   12.0416                   41.1096                   56.8243                   78.7464                   94.8262                   68.0                      
29                        103.8316                  91.351                    29.9666                   48.0208                   70.6045                   69.527                    69.4046                   68.9638                   67.72                     40.1123                   38.2753                   55.109                    66.7083                   87.0                      96.6488                   82.8734                   80.0                      102.5914                  108.2589                  95.3362                   106.5129                  115.6028                  82.0731                   71.5891                   56.3649                   47.0106                   28.7924                   12.0416                   99999.0                   32.3883                   53.9073                   79.925                    98.4327                   71.7844                   
30                        118.8276                  89.2861                   29.0689                   75.6902                   95.8541                   90.7359                   89.0505                   85.9127                   78.7464                   49.4975                   54.6443                   65.192                    62.3618                   88.0227                   111.7318                  94.4934                   99.4032                   125.1958                  114.5295                  104.0096                  119.3315                  130.8625                  105.1903                  100.1699                  85.1469                   76.2955                   59.2115                   41.1096                   32.3883                   99999.0                   31.3209                   63.7887                   87.0517                   63.6396                   
31                        106.8504                  65.0                      29.1204                   82.6075                   97.3293                   87.8635                   84.6463                   79.0569                   67.082                    44.2832                   54.0093                   55.3624                   39.6989                   66.2193                   100.3444                  81.3019                   93.6056                   121.1652                  94.921                    87.2067                   105.2093                  118.4314                  103.1601                  106.1179                  92.6553                   85.5102                   72.45                     56.8243                   53.9073                   31.3209                   99999.0                   33.0151                   57.3149                   37.5899                   
32                        94.8314                   41.0488                   50.2195                   93.4773                   101.1385                  88.2836                   83.863                    76.4199                   61.0737                   53.0                      63.6318                   54.8179                   27.1662                   46.0977                   89.627                    70.7107                   90.0888                   117.0171                  74.4312                   71.1688                   90.7579                   104.9952                  102.7035                  113.5473                  102.8834                  98.1122                   90.1388                   78.7464                   79.925                    63.7887                   33.0151                   99999.0                   25.0                      19.0                      
33                        85.0059                   27.0185                   68.6222                   101.3163                  103.3538                  89.0                      84.0952                   76.0592                   60.3738                   64.405                    73.7564                   59.6657                   33.6006                   35.3553                   81.3019                   64.5368                   87.5957                   112.1784                  58.6941                   60.0                      79.1581                   93.3435                   101.5923                  117.6605                  109.6358                  106.8316                  102.8008                  94.8262                   98.4327                   87.0517                   57.3149                   25.0                      99999.0                   26.8328                   
34                        76.5376                   27.4591                   42.2019                   77.1038                   82.8613                   69.6348                   65.1153                   57.5587                   42.107                    38.2099                   48.1664                   36.7696                   8.544                     29.8329                   71.0634                   51.9711                   71.1126                   98.0204                   58.8982                   53.6656                   73.0068                   87.0919                   83.863                    95.8541                   86.093                    82.201                    76.5768                   68.0                      71.7844                   63.6396                   37.5899                   19.0                      26.8328                   99999.0                   
;
SCALAR TOTAL  /34/;
SCALAR NODES  /30/;
SCALAR W  /1/;
SCALAR Y  /34/;
SCALAR M  /1/;
BINARY VARIABLE X(I,J,K)  x variable ;
INTEGER VARIABLE U(K,O)    u variable ;
VARIABLE   Z         objective ;
EQUATIONS
CON1(K)   constraint 1
CON2(K)   constraint 2
CON3   constraint 3
CON4(O)   constraint 4
CON5(O,K)   constraint 5
CON6(O,K)   constraint 6
CON7(K)   constraint 7
CON10(O,P,K)   constraint 10
CON11(O,K)   constraint 11;
CON1(K).. SUM(O,X(K,O,K)) =E= 1;
CON2(K).. SUM(O,X(O,K,K)) =E= 1;
CON3..  SUM((K,L),X(K,L,K)) =E= 0;
CON4(O) .. SUM(K,X(K,O,K)) + SUM((P,K),X(P,O,K)) =e= W;
CON5(O,K) .. X(K,O,K) + SUM(P,X(P,O,K)) =L= 1;
CON6(O,K) .. X(K,O,K) + SUM(P,X(P,O,K)) - X(O,K,K) - SUM(P,X(O,P,K)) =e= 0;
CON7(K) .. Z =G= SUM(O,C(K,O)*X(K,O,K) + C(O,K)*X(O,K,K)) + SUM((P,O),C(P,O)*X(P,O,K));
CON10(O,P,K) .. U(K,O) - U(K,P) + (TOTAL-1)*X(O,P,K) + (TOTAL-3)*X(P,O,K) =L= (TOTAL-2);
CON11(O,K) .. X(O,O,K) =e= 0;
MODEL TRANSPORT /ALL/;
SOLVE TRANSPORT USING MIP MINIMIZING Z ;
