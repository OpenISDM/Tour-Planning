SET
I  first /1*20/
K(I)  depot1 /1*3/
O(I)  node1 /4*20/
alias(I,J);
alias(K,L);
alias(O,P);
TABLE C(I,J)  node to node
                          1                         2                         3                         4                         5                         6                         7                         8                         9                         10                        11                        12                        13                        14                        15                        16                        17                        18                        19                        20                        
1                         99999.0                   99999.0                   99999.0                   53.9073                   31.241                    10.7703                   25.02                     46.0435                   55.9017                   42.72                     35.4401                   48.7647                   55.3624                   54.231                    60.8769                   75.0267                   69.6563                   21.9317                   17.72                     24.1868                   
2                         99999.0                   99999.0                   99999.0                   25.0                      17.0                      27.7308                   19.7231                   21.095                    17.4929                   31.241                    48.4665                   63.9766                   63.0079                   55.1725                   47.4236                   54.5894                   39.0512                   44.1814                   53.1507                   23.5372                   
3                         99999.0                   99999.0                   99999.0                   34.2053                   39.8497                   58.0345                   65.2534                   74.4312                   55.9732                   23.0868                   33.2866                   36.3593                   25.632                    15.2643                   7.6158                    20.6155                   36.8782                   45.31                     62.2415                   41.1947                   
4                         53.9073                   25.0                      34.2053                   99999.0                   22.6716                   44.6542                   43.1741                   44.3847                   21.9317                   20.025                    45.5412                   58.0345                   52.3927                   42.0595                   26.9072                   30.0832                   15.8114                   48.7545                   63.2456                   30.4795                   
5                         31.241                    17.0                      39.8497                   22.6716                   99999.0                   22.3607                   25.4951                   36.7696                   30.0167                   16.7631                   31.6228                   47.0106                   46.2277                   39.0512                   35.3553                   46.5296                   38.4187                   29.2746                   41.5933                   8.544                     
6                         10.7703                   27.7308                   58.0345                   44.6542                   22.3607                   99999.0                   15.8114                   36.4966                   45.1774                   36.3456                   36.0555                   51.0882                   55.4707                   52.2015                   55.2268                   68.1542                   60.4649                   24.8395                   27.0185                   17.1172                   
7                         25.02                     19.7231                   65.2534                   43.1741                   25.4951                   15.8114                   99999.0                   21.0238                   36.0694                   42.2019                   49.4975                   65.1153                   67.8012                   62.6498                   60.8276                   71.0282                   58.1893                   39.9625                   42.4264                   25.5539                   
8                         46.0435                   21.095                    74.4312                   44.3847                   36.7696                   36.4966                   21.0238                   99999.0                   27.2947                   52.2015                   66.5733                   82.3772                   82.8794                   75.743                    68.4251                   74.4648                   56.0357                   59.2368                   63.3877                   41.0488                   
9                         55.9017                   17.4929                   55.9732                   21.9317                   30.0167                   45.1774                   36.0694                   27.2947                   99999.0                   38.0789                   60.6712                   75.1864                   71.6938                   62.1772                   48.7955                   50.5371                   29.6142                   59.2115                   69.9214                   38.2099                   
10                        42.72                     31.241                    23.0868                   20.025                    16.7631                   36.3456                   42.2019                   52.2015                   38.0789                   99999.0                   25.7099                   38.1182                   33.6155                   24.4131                   19.0                      32.311                    32.2025                   31.241                    47.4236                   19.2354                   
11                        35.4401                   48.4665                   33.2866                   45.5412                   31.6228                   36.0555                   49.4975                   66.5733                   60.6712                   25.7099                   99999.0                   15.8114                   19.9249                   20.6155                   35.3553                   51.6236                   57.5847                   14.0357                   29.8329                   25.5539                   
12                        48.7647                   63.9766                   36.3593                   58.0345                   47.0106                   51.0882                   65.1153                   82.3772                   75.1864                   38.1182                   15.8114                   99999.0                   12.2066                   21.095                    41.2311                   56.8243                   67.897                    26.9258                   38.4708                   41.3401                   
13                        55.3624                   63.0079                   25.632                    52.3927                   46.2277                   55.4707                   67.8012                   82.8794                   71.6938                   33.6155                   19.9249                   12.2066                   99999.0                   11.0454                   31.5753                   46.2385                   60.0083                   33.7343                   48.0104                   42.5206                   
14                        54.231                    55.1725                   15.2643                   42.0595                   39.0512                   52.2015                   62.6498                   75.743                    62.1772                   24.4131                   20.6155                   21.095                    11.0454                   99999.0                   20.6155                   35.7771                   49.0                      34.2345                   50.448                    37.1214                   
15                        60.8769                   47.4236                   7.6158                    26.9072                   35.3553                   55.2268                   60.8276                   68.4251                   48.7955                   19.0                      35.3553                   41.2311                   31.5753                   20.6155                   99999.0                   16.2788                   29.4279                   45.793                    62.7694                   38.1182                   
16                        75.0267                   54.5894                   20.6155                   30.0832                   46.5296                   68.1542                   71.0282                   74.4648                   50.5371                   32.311                    51.6236                   56.8243                   46.2385                   35.7771                   16.2788                   99999.0                   23.3452                   61.6117                   78.492                    51.2445                   
17                        69.6563                   39.0512                   36.8782                   15.8114                   38.4187                   60.4649                   58.1893                   56.0357                   29.6142                   32.2025                   57.5847                   67.897                    60.0083                   49.0                      29.4279                   23.3452                   99999.0                   62.9682                   78.2432                   45.9674                   
18                        21.9317                   44.1814                   45.31                     48.7545                   29.2746                   24.8395                   39.9625                   59.2368                   59.2115                   31.241                    14.0357                   26.9258                   33.7343                   34.2345                   45.793                    61.6117                   62.9682                   99999.0                   17.0                      21.0238                   
19                        17.72                     53.1507                   62.2415                   63.2456                   41.5933                   27.0185                   42.4264                   63.3877                   69.9214                   47.4236                   29.8329                   38.4708                   48.0104                   50.448                    62.7694                   78.492                    78.2432                   17.0                      99999.0                   33.121                    
20                        24.1868                   23.5372                   41.1947                   30.4795                   8.544                     17.1172                   25.5539                   41.0488                   38.2099                   19.2354                   25.5539                   41.3401                   42.5206                   37.1214                   38.1182                   51.2445                   45.9674                   21.0238                   33.121                    99999.0                   
;
SCALAR TOTAL  /20/;
SCALAR NODES  /17/;
SCALAR W  /1/;
SCALAR Y  /20/;
SCALAR M  /1/;
BINARY VARIABLE X(I,J,K)  x variable ;
INTEGER VARIABLE U(K,O)    u variable ;
VARIABLE   Z         objective ;
EQUATIONS
CON1(K)   constraint 1
CON2(K)   constraint 2
CON3   constraint 3
CON4(O)   constraint 4
CON5(O,K)   constraint 5
CON6(O,K)   constraint 6
CON7(K)   constraint 7
CON10(O,P,K)   constraint 10
CON11(O,K)   constraint 11;
CON1(K).. SUM(O,X(K,O,K)) =E= 1;
CON2(K).. SUM(O,X(O,K,K)) =E= 1;
CON3..  SUM((K,L),X(K,L,K)) =E= 0;
CON4(O) .. SUM(K,X(K,O,K)) + SUM((P,K),X(P,O,K)) =e= W;
CON5(O,K) .. X(K,O,K) + SUM(P,X(P,O,K)) =L= 1;
CON6(O,K) .. X(K,O,K) + SUM(P,X(P,O,K)) - X(O,K,K) - SUM(P,X(O,P,K)) =e= 0;
CON7(K) .. Z =G= SUM(O,C(K,O)*X(K,O,K) + C(O,K)*X(O,K,K)) + SUM((P,O),C(P,O)*X(P,O,K));
CON10(O,P,K) .. U(K,O) - U(K,P) + (TOTAL-1)*X(O,P,K) + (TOTAL-3)*X(P,O,K) =L= (TOTAL-2);
CON11(O,K) .. X(O,O,K) =e= 0;
MODEL TRANSPORT /ALL/;
SOLVE TRANSPORT USING MIP MINIMIZING Z ;
